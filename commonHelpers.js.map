{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst BASE_URL = 'https://pixabay.com';\nconst PATH = '/api/';\nconst PARAMS = {\n  key: '43828991-79d1a60f3e87126db3a63842a',\n  imageType: 'photo',\n  orientation: 'horizontal',\n  safesearch: 'true',\n};\n\nconst getSearchParams = (searchInputValue, page, perPage) => {\n  const parameters = new URLSearchParams(PARAMS);\n  parameters.append('q', searchInputValue);\n  parameters.append('page', page);\n  parameters.append('per_page', perPage);\n  return parameters;\n};\n\nexport const fetchImages = async (searchInputValue, page = 1, perPage = 15) => {\n  const url = `${BASE_URL}${PATH}?${getSearchParams(\n    searchInputValue,\n    page,\n    perPage\n  )}`;\n  try {\n    const response = await axios.get(url);\n    return response.data;\n  } catch (error) {\n    throw new Error(error.response ? error.response.status : error.message);\n  }\n};\n","export const renderImages = items => {\n  const htmlString = items\n    .map(\n      image => `\n    <li class=\"gallery-item\">\n        <a class=\"gallery-link\" href=\"${image.largeImageURL}\">\n            <img\n            class=\"gallery-image\"\n            src=\"${image.webformatURL}\"\n            alt=\"${image.tags}\"\n            />\n        </a>\n        <div class=\"info\">\n                        <p class=\"info-item\">\n                            <b>Likes</b>\n                            <span>${image.likes}</span> \n                        </p>\n                        <p class=\"info-item\">\n                            <b>Views</b>\n                            <span>${image.views}</span>\n                        </p>\n                        <p class=\"info-item\">\n                            <b>Comments</b>\n                            <span>${image.comments}</span>\n                        </p>\n                        <p class=\"info-item\">\n                            <b>Downloads</b>\n                            <span>${image.downloads}</span>\n                        </p>\n                    </div>\n    </li>\n\n`\n    )\n    .join('');\n\n  document.querySelector('.gallery').innerHTML = htmlString;\n};\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport { fetchImages } from './js/pixabay-api';\nimport { renderImages } from './js/render-functions';\n\nlet page = 1;\nconst PER_PAGE = 15;\nlet images = [];\nlet query = '';\nlet total = 0;\nlet rect;\n\nconst searchForm = document.querySelector('.search-form');\nconst loadMoreButton = document.querySelector('.load-button');\nconst loader = document.querySelector('.loader');\n\nlet lightbox = new SimpleLightbox('.gallery a');\nupdateLoadButton('none');\n\nconst onFormSubmit = async event => {\n  event.preventDefault();\n  updateLoader('block');\n  const form = event.target;\n  const userInput = form.elements.searchInput.value;\n  if (userInput.trim() === '') {\n    alert('please fill in the line');\n    updateLoader('none');\n    return;\n  }\n  try {\n    page = 1;\n    const data = await fetchImages(userInput);\n    updateLoader('none');\n    updateLoadButton('block');\n\n    if (data.totalHits === 0) {\n      updateLoadButton('none');\n      showMessage(\n        `Sorry, there are no images matching your search query. Please try again!`\n      );\n    }\n    renderImages(data.hits);\n    lightbox.refresh();\n    query = userInput;\n    total = data.totalHits;\n    if (total !== 0 && total <= PER_PAGE) {\n      updateLoadButton('none');\n      showMessage(`We're sorry, but you've reached the end of search results.`);\n    }\n    images = data.hits;\n    let elem = document.querySelector('.gallery-item');\n    rect = elem?.getBoundingClientRect();\n  } catch (error) {\n    updateLoader('none');\n    showError(error.message);\n  }\n};\n\nconst onLoadMoreButtonClick = async event => {\n  event.preventDefault();\n  try {\n    page = page + 1;\n    const data = await fetchImages(query, page, PER_PAGE);\n    updateLoader('none');\n    const result = [...images, ...data.hits];\n    renderImages(result);\n    if (!rect) {\n      scrollBy(0, rect.height * 2);\n    }\n    lightbox.refresh();\n    images = result;\n    if (images.length >= total) {\n      updateLoadButton('none');\n      showMessage(`We're sorry, but you've reached the end of search results.`);\n      return;\n    }\n  } catch (error) {\n    updateLoader('none');\n    showError(error.message);\n  }\n};\n\nsearchForm.addEventListener('submit', onFormSubmit);\nloadMoreButton.addEventListener('click', onLoadMoreButtonClick);\n\nfunction showError(errorMessage) {\n  iziToast.show({\n    title: 'Error',\n    message: errorMessage,\n    messageColor: 'white',\n    backgroundColor: 'tomato',\n  });\n}\n\nfunction showMessage(message) {\n  iziToast.show({\n    title: 'Message',\n    message: message,\n    messageColor: 'white',\n    backgroundColor: 'teal',\n  });\n}\n\nfunction updateLoader(value) {\n  loader.style.display = value;\n}\n\nfunction updateLoadButton(value) {\n  loadMoreButton.style.display = value;\n}\n"],"names":["BASE_URL","PATH","PARAMS","getSearchParams","searchInputValue","page","perPage","parameters","fetchImages","url","axios","error","renderImages","items","htmlString","image","PER_PAGE","images","query","total","rect","searchForm","loadMoreButton","loader","lightbox","SimpleLightbox","updateLoadButton","onFormSubmit","event","updateLoader","userInput","data","showMessage","elem","showError","onLoadMoreButtonClick","result","errorMessage","iziToast","message","value"],"mappings":"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"}